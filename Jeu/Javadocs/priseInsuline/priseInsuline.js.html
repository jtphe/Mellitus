<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: priseInsuline.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: priseInsuline.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Discord = require('discord.js');
const fs = require('fs');
const event = require('./event.js');
const sfm = require('../Main/saveFileManagement.js');
const calcul = require('./calcul.js');
const config = require('../token.json');

const client = new Discord.Client();
client.login(config.token);

const tabNb = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];

/** Fonction qui affiche un embed pour la prise d'insuline et qui récupère la valeur
* @param {string} message - Message discord
* @param {Object} partie - Objet json de la partie
* @param {number} partie.insuline - Permet de prendre de l'insuline, ou pas
 */
exports.priseInsuline = function priseInsuline(message, partie) {

  let insuline = '-1';

  const text = 'C\'est l\'heure de la prise d\'insuline.';

  const embed = new Discord.RichEmbed()
    .setColor(0x00AE86)
    .addField(text, 'Je dois prendre de l\'insuline (entre 0 et 80 unités): ')
  message.channel.send({ embed });

  partie.insuline = 1;
  sfm.save(message.author.id, partie);

  client.on ('message', message => {

    if(message.author.bot) return;

    if(!message.content.startsWith(config.prefix)) {

      if(message.member.roles.some(r=>['Joueur'].includes(r.name)))
      {
        let bool = true;
        if (partie.insuline == 1)
        {
          if(message.content.length == 1 || message.content.length == 2) {
            for(let i = 0; i &lt; message.content.length; i++) {
              if(!tabNb.includes(message.content.charAt(i))) {
                bool = false;
              }
            }
          }
          else{
            bool = false;
          }
          insuline = parseInt(message.content);

          if(bool == true)
          {
            if(insuline &lt; 0 || insuline > 80 || isNaN(insuline))
            {
              message.channel.send('Entrez une valeur comprise entre 0 et 80 !');
            }
            else
            {
              calcul.glyInsu(partie, insuline);
              partie.insuline = 0;
              sfm.save(message.author.id, partie);
              message.react('➡');
            }
          }
          else{
            message.channel.send('Mettez-y du votre aussi !')
          }
        }
      }
    }
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#priseInsuline">priseInsuline</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Dec 13 2018 15:10:22 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
